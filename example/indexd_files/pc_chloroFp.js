(function(){var siteId="c7e55b219200",jsUrl="//webresource.c-ctrip.com/resaresonline/risk/ubtrms/latest/default/chlorofp.js",url=jsUrl+"?siteId="+siteId,timeout=10,chloroFp_sdk_url="https://b.qunar.com/chloroFp_sdk",event_type_list=["activation","login","logout","browse","place_order","pay","pay_ok","custom","fp"];var now=new Date();setTimeout(function(){var f=document.createElement("script");f.type="text/javascript";f.id="cfp__script";f.async=true;f.src=("https:"==document.location.protocol?"https:":"http:")+url+"&v="+now.getYear()+"-"+now.getMonth()+"-"+now.getDate();var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(f,s)},timeout);window.cfp__startScriptLoad=1*new Date();if(window.addEventListener){window.addEventListener("load",load)}else{window.attachEvent("onload",load)}function load(){var timeout=400;setTimeout(function(){window.__cfpi=window.__cfpi||[];window.__cfpi.push(["_getChloroToken",function(result){window.__fpToken=result;Bfp_init.prototype.bfp_event.call({initObj:{site_id:"qunar",retry:3}},"fp")}])},timeout)}if(!Function.prototype.bind){Function.prototype.bind=function(oThis){if(typeof this!=="function"){return}var aArgs=Array.prototype.slice.call(arguments,1),fToBind=this,fNOP=function(){};var fBound=function(){return fToBind.apply(this instanceof fNOP?this:oThis,aArgs.concat(Array.prototype.slice.call(arguments)))};fNOP.prototype=this.prototype;fBound.prototype=new fNOP();return fBound}}window.Bfp_init=function Bfp_init(init){if(!(this instanceof Bfp_init)){return new Bfp_init(init)}if(init.site_id){init.retry=3;this.initObj=init;window.bfp_event=this.bfp_event.bind(this);bfp_event("activation")}};Bfp_init.prototype.bfp_event=function(event_type,options,callback){if(event_type_list.join(",").indexOf(event_type)===-1){return false}if(event_type==="custom"&&!options.event_type){return false}if(Object.prototype.toString.call(options)==="[object Function]"){callback=options;options={}}if(options===null||options===undefined){options={}}var initObj=this.initObj;var message={siteId:initObj.site_id,eventType:event_type,data:options,fpToken:window.__fpToken||""};var t=0;if(navigator.appName==="Microsoft Internet Explorer"&&navigator.userAgent.match(/Trident/i)&&navigator.userAgent.match(/MSIE 9.0|MSIE 8.0/i)){message.isIfream="true";bfp_ifream(message)}else{bfp_ajax()}function bfp_ajax(){var xhr=createXHR();callback?xhr.onreadystatechange=function(){if(xhr.readyState==4){if((xhr.status>=200&&xhr.status<300)||xhr.status==304){var result={};try{result=JSON.parse(xhr.responseText)}catch(e){result=eval("("+xhr.responseText+")")}canPass(callback,true,result)}else{t++<initObj.retry?bfp_ajax():canPass(callback,false)}}}:null;xhr.open("post",chloroFp_sdk_url,true);xhr.withCredentials=true;xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var param={};try{param=JSON.stringify(message)}catch(e){}xhr.send("_message="+param)}function createXHR(){if(typeof XMLHttpRequest!="undefined"){return new XMLHttpRequest()}else{if(typeof ActiveXObject!="undefined"){if(typeof arguments.callee.activeXString!="string"){var versions=["MSXML2.XMLHttp.6.0","MSXML2.XMLHttp.3.0","MSXML2.XMLHttp"],i,len;for(i=0,len=versions.length;i<len;i++){try{new ActiveXObject(versions[i]);arguments.callee.activeXString=versions[i];break}catch(ex){}}}return new ActiveXObject(arguments.callee.activeXString)}}}function canPass(fn,isSuccess,data){t=0;try{fn&&fn(isSuccess,data)}catch(error){}}function bfp_ifream(message){var form=document.createElement("form");form.target="11beeIframe";form.method="post";form.action=chloroFp_sdk_url;form.id="11bee__form";form.style.display="none";document.body.appendChild(form);var input=document.createElement("input");input.type="hidden";input.name="_message";var msg="";try{msg=JSON.stringify(message)}catch(e){}input.value=msg;var bee__form=document.getElementById("11bee__form");bee__form.appendChild(input);var iframe_11b=document.createElement("iframe");iframe_11b.name="11beeIframe";iframe_11b.id="11bee__Iframe";iframe_11b.style.display="none";document.body.appendChild(iframe_11b);bee__form.submit();setTimeout(function(){document.body.removeChild(iframe_11b)},0)}}})();